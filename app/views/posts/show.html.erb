<div class="page-title ml-4 mt-4"><%= @post.user.name %>さんの釣果</div>
<div class="row mr-4">
    <div class="col-3">
        <div class="card mt-5 ml-5" style="width: 18rem;">
            <% if @post.user.image.attached? %>
                    <%= image_tag @post.user.image, class:" post-user-img"%>
            <% else %>
                    <img src="../assets/user-image.png" class=" post-user-img">
            <% end %>
            <div class="card-body">
                <h5 class="card-title text-center card-label"><%= @post.user.name%></h5>
                <p class="card-text text-center">
                    <% if @post.user.introduce? %>
                        <%= @post.user.introduce %>
                    <% else %>
                        <div class="user-introduce-default text-center">
                            まだ自己紹介がありません
                        </div>
                    <% end %>
                </p>
                <div class="text-right">
                   <%= link_to "詳細","/users/#{@post.user.id}",class:"btn-sm btn-info" %> 
                </div>
           </div>
        </div>
    </div>
    <div class="col-9">
        <div class="post-data-area mx-auto">
            <div class="post-show-title mt-5 mb-5">
                <%= @post.name%>
            </div>
            <% if @post.image.attached? %>
                <%= image_tag @post.image,class:"post-show-img"%>
            <% else %>
                <div class="ml-5">
                    <img src="../assets/sakana-img.jpg" class=" post-show-img default-img">
                </div>
                <div class="default-text text-right mr-5 pr-1">
                    画像が添付されていません
                </div>
            <% end %> 
                <div class="data-area-title pt-5">
                    投稿のデータ
                </div>
                <ul class="post-data-list mt-5">
                    <li class="post-created_at"><%= @post.created_at %></li>
                    <li class="like-icon ml-5"><i class="fas fa-heart"> <%= @likes_count %></i></li>
                    <li class="comment-icon ml-5"><i class="fas fa-comment"> 8</i></li>
                </ul>
                <div class="data-area-title mt-5">
                    釣果のデータ
                </div>
                <ul class="post-data-list mt-5">
                        <li><span class="badge badge-info mr-3">この魚の難易度: <span class="star-color"><%= @level %></span></span></li>
                    <% if @post.number? %>
                       <li><span class="badge badge-info mr-3">数量: <%= @post.number %></span></li>
                    <% end %>
                    <% if @post.date? %>
                        <li><span class="badge badge-info mr-3">日時: <%= @post.date %></span></li>
                    <% end %>
                    <% if @post.feed? %>
                       <li><span class="badge badge-info mr-3">使用した餌: <%= @post.feed %></span></li>
                    <% end %>
                    <% if @post.weather? %>
                        <li><span class="badge badge-info mr-3">天気: <%= @post.weather %></span></li>
                    <% end %>
                </ul>
                <div class="data-area-title mt-5">
                    説明
                </div>
                    <ul class="post-data-list mt-5">
                        <li>
                            <% if @post.description? %>  
                                <div class="post-show-description">
                                    <%= @post.description %>
                                </div>
                            <% else %>
                                <div class="post-description-default text-center default-text">
                                    説明がありません
                                </div>
                            <% end %>
                        </li>
                    </ul>
                <div class="data-area-title mt-5">
                    釣れた場所
                </div>
                    <div class="post-map-area mb-4 pt-4">
                        <div id="map" style='width: 95%; height: 500px;'></div>
                        <script type="text/javascript">
                        handler = Gmaps.build('Google');
                        handler.buildMap({ provider: { scrollwheel: false }, internal: {id: 'map'}}, function(){
                          markers = handler.addMarkers([
                            {
                              "lat": <%= @post.latitude %>,
                              "lng": <%= @post.longitude %>,
                        	  "infowindow": '<%= @post.address %></p><p><%= link_to "Googleマップで見る" ,"https://maps.google.co.jp/maps?q=loc:#{@post.latitude},#{@post.longitude}&iwloc=J",target: "_blank" %></p>',
                        	  "picture": {
                        	       "url": '<%= asset_path "map-icon.png" %>',
                                    "width":  48,
                                    "height": 48
                                }
                            }
                          ]);
                          handler.bounds.extendWith(markers);
                          handler.fitMapToBounds();
                          handler.getMap().setZoom(17);
                        });
                        </script>
                    </div>
                    
                <% if Like.find_by(user_id: @current_user.id, post_id: @post.id) %>
                    <%= link_to("/likes/#{@post.id}/destroy", {method: "post"}) do %>
                        <div class="text-right like-btn-wrapper">
                            <span class="fa fa-heart like-btn-unlike mr-5 mb-3"></span>
                        </div>
                    <% end %>
                <% else %>
                    <%= link_to("/likes/#{@post.id}/create", {method: "post"}) do %>
                        <div class="text-right like-btn-wrapper">
                            <span class="fa fa-heart like-btn mr-5 mb-3"></span>
                        </div>
                    <% end %>
                <% end %>
                 
                <% if @post.user.id == current_user.id %>
                    <div class="post-btn-area text-right mb-2 mr-5">
                        <%= link_to '編集', edit_post_path(@post),class:"btn-sm btn-info" %> 
                        <%= link_to '削除', @post, method: :delete, data: { confirm: 'Are you sure?' },class:"btn-sm btn-danger" %>
                    </div>
                <% end %>
                <div class="data-area-title mt-5">
                    <%= @post.name %>のデータ
                </div>
                <div class="row no-gutters mb-5">
                    <div class="col-6 mt-5">
                        <div class="season-data-label mt-5 mb-5"><%= @post.name%>がよく釣れる時期</div>
                            <%= line_chart @data1, width: "100%", height: "300px"%>
                    </div>
                    <div class="col-6 mt-5">
                        <div class="feed-data-label mt-5 mb-5"><%= @post.name%>がよく釣れる餌</div>
                            <%= pie_chart @data2, width: "100%", height: "300px"%>
                     </div>
                </div>
                
        </div>
    </div>
</div>













